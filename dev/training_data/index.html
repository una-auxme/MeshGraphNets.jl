<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Training Data · MeshGraphNets.jl</title><meta name="title" content="Training Data · MeshGraphNets.jl"/><meta property="og:title" content="Training Data · MeshGraphNets.jl"/><meta property="twitter:title" content="Training Data · MeshGraphNets.jl"/><meta name="description" content="Documentation for MeshGraphNets.jl."/><meta property="og:description" content="Documentation for MeshGraphNets.jl."/><meta property="twitter:description" content="Documentation for MeshGraphNets.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../overview/">Overview</a></li><li><span class="tocitem">Getting Started</span><ul><li class="is-active"><a class="tocitem" href>Training Data</a><ul class="internal"><li><a class="tocitem" href="#Folder-Structure"><span>Folder Structure</span></a></li><li><a class="tocitem" href="#Files-for-Training,-Evaluation-and-Testing"><span>Files for Training, Evaluation and Testing</span></a></li><li><a class="tocitem" href="#File-for-Metadata-(meta.json)"><span>File for Metadata (<code>meta.json</code>)</span></a></li></ul></li><li><a class="tocitem" href="../train_eval/">Training &amp; Evaluation</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../cylinder_flow/">CylinderFlow</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../strategies/">Training Strategies</a></li><li><a class="tocitem" href="../util/">Utilities</a></li><li><a class="tocitem" href="../graph_net_core/">GraphNetCore.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Getting Started</a></li><li class="is-active"><a href>Training Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Training Data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/una-auxme/MeshGraphNets.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Training-Data"><a class="docs-heading-anchor" href="#Training-Data">Training Data</a><a id="Training-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Training-Data" title="Permalink"></a></h1><p>If you want to train your own network via <em>MeshGraphNets.jl</em> you have to provide your data files and a corresponding metadata file in a specific manner. This section describes the structure of those files.</p><h2 id="Folder-Structure"><a class="docs-heading-anchor" href="#Folder-Structure">Folder Structure</a><a id="Folder-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Folder-Structure" title="Permalink"></a></h2><p>Your files have to be placed inside the same folder so that <em>MeshGraphNets.jl</em> can find them. The structure of your files should for example look like this:</p><pre><code class="nohighlight hljs">- data
  - meta.json
  - test.h5 (or test.tfrecord)
  - train.h5 (or train.tfrecord)
  - valid.h5 (or valid.tfrecord)</code></pre><h2 id="Files-for-Training,-Evaluation-and-Testing"><a class="docs-heading-anchor" href="#Files-for-Training,-Evaluation-and-Testing">Files for Training, Evaluation and Testing</a><a id="Files-for-Training,-Evaluation-and-Testing-1"></a><a class="docs-heading-anchor-permalink" href="#Files-for-Training,-Evaluation-and-Testing" title="Permalink"></a></h2><p>For each of the steps a separate file has to be provided (see <a href="#folder-structure">Folder Structure</a>). It is recommended to use <code>HDF5</code> files since they are easier to work with in Julia. You can also use <code>TFRecord</code> files, however an implementation is only provided for handling files that are exactly like the ones from the <a href="https://una-auxme.github.io/MeshGraphNets.jl/dev/cylinder_flow">CylinderFlow</a> example.</p><blockquote><p>⚠️ The following sections only contain explanations for using <code>HDF5</code> files.</p></blockquote><h3 id="Data-File-Structure-(train.h5,-valid.h5,-test.h5)"><a class="docs-heading-anchor" href="#Data-File-Structure-(train.h5,-valid.h5,-test.h5)">Data File Structure (<code>train.h5</code>, <code>valid.h5</code>, <code>test.h5</code>)</a><a id="Data-File-Structure-(train.h5,-valid.h5,-test.h5)-1"></a><a class="docs-heading-anchor-permalink" href="#Data-File-Structure-(train.h5,-valid.h5,-test.h5)" title="Permalink"></a></h3><p>Your data files should have the following structure:</p><ul><li><em>trajectory_1</em><ul><li><em>feature<em>key</em>1</em></li><li><em>feature<em>key</em>2</em></li><li>...</li></ul></li><li><em>trajectory_2</em><ul><li><em>feature<em>key</em>1</em></li><li><em>feature<em>key</em>2</em></li><li>...</li></ul></li><li>...</li></ul><p>The name of the trajectories can be chosen arbitrarily whereas the keys of the features have to match the ones provided in the metadata file (see <a href="#file-for-metadata-metajson">File for Metadata</a>).</p><h2 id="File-for-Metadata-(meta.json)"><a class="docs-heading-anchor" href="#File-for-Metadata-(meta.json)">File for Metadata (<code>meta.json</code>)</a><a id="File-for-Metadata-(meta.json)-1"></a><a class="docs-heading-anchor-permalink" href="#File-for-Metadata-(meta.json)" title="Permalink"></a></h2><p>Your metadata file also has to follow a defined structure. Since the metadata file for the <a href="https://una-auxme.github.io/MeshGraphNets.jl/dev/cylinder_flow">CylinderFlow</a> example is handled differently, two files are explained in the following.</p><h3 id="Default-Metadata"><a class="docs-heading-anchor" href="#Default-Metadata">Default Metadata</a><a id="Default-Metadata-1"></a><a class="docs-heading-anchor-permalink" href="#Default-Metadata" title="Permalink"></a></h3><p>The default structure that you should use for your metadata is the following (example derived from the <a href="#cylinderflow-metadata">CylinderFlow metadata</a>, not an actual metadata file):</p><pre><code class="language-json hljs">{
    &quot;dt&quot;: &quot;time&quot;,                               # key inside the HDF5 file for timesteps
    &quot;trajectory_length&quot;: 600,                   # length of trajectories (i.e. number of steps) inside data files
    &quot;dims&quot;: [                                   # dimensions of the mesh (here a mesh of dimensions (5, 3))
        5,
        3
    ],
    &quot;edges&quot;: {                                  # minimum and maximum value of edge features (optional)
      &quot;data_min&quot;: -0.2,
      &quot;data_max&quot;: 0.2
    },
    &quot;no_edges_node_types&quot;: [],                  # node types that should not have a connection inside the mesh (optional)
    &quot;feature_names&quot;: [                          # names of all features, mesh_pos and node_type are required
        &quot;mesh_pos&quot;,
        &quot;node_type&quot;,
        &quot;velocity&quot;
    ],
    &quot;target_features&quot;: [                        # names of target features (i.e. quantities of interest) as output of the network
        &quot;velocity&quot;
    ],
    &quot;features&quot;: {                               # detailed information of the features given above
        &quot;mesh_pos&quot;: {                           # name of the feature given above
            &quot;key&quot;: &quot;cl_mesh[%d,%d].pos&quot;,        # key inside the HDF5 file for the feature, see below
            &quot;split&quot;: true,                      # true if your feature is split between multiple keys, false otherwise
            &quot;dim&quot;: 2,                           # dimension of the feature
            &quot;type&quot;: &quot;static&quot;,                   # &quot;static&quot; if the feature does not change over time, &quot;dynamic&quot; otherwise
            &quot;dtype&quot;: &quot;float32&quot;                  # data type of the feature
        },
        &quot;node_type&quot;: {
            &quot;key&quot;: &quot;cl_mesh[%d,%d].cellType&quot;,
            &quot;dim&quot;: 1,
            &quot;type&quot;: &quot;static&quot;,
            &quot;dtype&quot;: &quot;int32&quot;,
            &quot;onehot&quot;: true,                     # should the feature be represented as a onehot vector (optional)
            &quot;data_min&quot;: 0,                      # minimum value of the feature (optional, required if &quot;data_max&quot; specified)
            &quot;data_max&quot;: 6                       # maximum value of the feature (optional, required if &quot;data_min&quot; specified)
        },
        &quot;velocity&quot;: {
            &quot;key&quot;: &quot;cl_mesh[%d,%d].velocity&quot;,
            &quot;dim&quot;: 2,
            &quot;type&quot;: &quot;dynamic&quot;,
            &quot;dtype&quot;: &quot;float32&quot;,
            &quot;output_min&quot;: -0.25,                # minimum value of the derivative of the feature (optional, required if &quot;data_max&quot; specified)
            &quot;output_max&quot;: 0.75                  # maximum value of the derivative of the feature (optional, required if &quot;data_min&quot; specified)
        }
    }
}</code></pre><p>Here is a detailed description of each possible metadata:</p><table><tr><th style="text-align: right">Metadata</th><th style="text-align: right">Data type</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>&quot;dt&quot;</code></td><td style="text-align: right">String</td><td style="text-align: right">each trajectory needs to have an entry for timesteps with the given key</td></tr><tr><td style="text-align: right"><code>&quot;trajectory_length&quot;</code></td><td style="text-align: right">Integer</td><td style="text-align: right">each trajectory needs to have the same length i.e. the same amount of steps</td></tr><tr><td style="text-align: right"><code>&quot;dims&quot;</code></td><td style="text-align: right">Vector{Integer}</td><td style="text-align: right">dimensions can be 1-, 2- or 3-dimensional</td></tr><tr><td style="text-align: right"><code>&quot;edges&quot;</code></td><td style="text-align: right">-</td><td style="text-align: right">if you specify <code>&quot;data_min&quot;</code> and <code>&quot;data_max&quot;</code>, offline normalization is used, online otherwise</td></tr><tr><td style="text-align: right"><code>&quot;no_edges_node_types&quot;</code></td><td style="text-align: right">Vector{Integer}</td><td style="text-align: right">if you want to exclude node types from the mesh, include them here</td></tr><tr><td style="text-align: right"><code>&quot;feature_names&quot;</code></td><td style="text-align: right">Vector{String}</td><td style="text-align: right">list all features that are also used as an input of the network</td></tr><tr><td style="text-align: right"><code>&quot;target_features&quot;</code></td><td style="text-align: right">Vector{String}</td><td style="text-align: right">list all features that the network should predict, they have to be part of <code>&quot;feature_names&quot;</code></td></tr></table><p>Each feature has its own metadata:</p><table><tr><th style="text-align: right">Feature Metadata</th><th style="text-align: right">Data Type</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>&quot;key&quot;</code></td><td style="text-align: right">String</td><td style="text-align: right">further description of <code>HDF5</code> key structure  are below</td></tr><tr><td style="text-align: right"><code>&quot;split&quot;</code></td><td style="text-align: right">Bool</td><td style="text-align: right">keys are split at the end (e.g. <code>&quot;cl_mesh[%d,%d].pos[1]&quot;</code> and <code>&quot;cl_mesh[%d,%d].pos[2]&quot;</code>)</td></tr><tr><td style="text-align: right"><code>&quot;dim&quot;</code></td><td style="text-align: right">Integer</td><td style="text-align: right">dimension of the feature</td></tr><tr><td style="text-align: right"><code>&quot;type&quot;</code></td><td style="text-align: right">String</td><td style="text-align: right"><code>&quot;static&quot;</code> if the feature does not change over time, <code>&quot;dynamic&quot;</code> otherwise</td></tr><tr><td style="text-align: right"><code>&quot;dtype&quot;</code></td><td style="text-align: right">String</td><td style="text-align: right">possible datatypes: <code>&quot;int32&quot;</code>, <code>&quot;float32&quot;</code>, <code>&quot;Bool&quot;</code></td></tr><tr><td style="text-align: right"><code>&quot;onehot&quot;</code></td><td style="text-align: right">Bool</td><td style="text-align: right">can be used if you want to convert types represented as Integer to a onehot vector</td></tr><tr><td style="text-align: right"><code>&quot;data_min&quot;</code></td><td style="text-align: right">Float</td><td style="text-align: right">if you specify <code>&quot;data_min&quot;</code> and <code>&quot;data_max&quot;</code>, offline normalization is used, online otherwise</td></tr><tr><td style="text-align: right"><code>&quot;data_max&quot;</code></td><td style="text-align: right">Float</td><td style="text-align: right">see <code>&quot;data_min&quot;</code></td></tr><tr><td style="text-align: right"><code>&quot;target_min&quot;</code></td><td style="text-align: right">Float</td><td style="text-align: right">equivalent to <code>&quot;data_min&quot;</code> and <code>&quot;data_max&quot;</code>, specifies interval for normalization target</td></tr><tr><td style="text-align: right"><code>&quot;target_max&quot;</code></td><td style="text-align: right">Float</td><td style="text-align: right">see <code>&quot;target_min&quot;</code></td></tr><tr><td style="text-align: right"><code>&quot;output_min&quot;</code></td><td style="text-align: right">Float</td><td style="text-align: right">equivalent to <code>&quot;data_min&quot;</code> and <code>data_max</code>, specifices the interval of the derivative of the feature</td></tr><tr><td style="text-align: right"><code>&quot;output_max&quot;</code></td><td style="text-align: right">Float</td><td style="text-align: right">see <code>&quot;output_min&quot;</code></td></tr></table><p>The structure for the <code>HDF5</code> key has to follow one rule:</p><blockquote><p>⚠️ Square brackets are exlusively used</p><ul><li>once for the index of the mesh point (e.g. <code>&quot;cl_mesh[%d,%d].cellType&quot;</code>) and</li><li>once at the end of the key if the feature <code>&quot;split&quot;</code> is set to <code>true</code>.</li></ul></blockquote><h3 id="CylinderFlow-Metadata"><a class="docs-heading-anchor" href="#CylinderFlow-Metadata">CylinderFlow Metadata</a><a id="CylinderFlow-Metadata-1"></a><a class="docs-heading-anchor-permalink" href="#CylinderFlow-Metadata" title="Permalink"></a></h3><p>The <a href="https://github.com/una-auxme/MeshGraphNets.jl/blob/main/examples/cylinder_flow/meta.json">metadata file</a> (taken from the from <a href="https://una-auxme.github.io/MeshGraphNets.jl/dev/cylinder_flow">CylinderFlow</a> example) has the following structure:</p><pre><code class="language-json hljs">{
    &quot;dt&quot;: 0.01,                     # time delta between steps in the data 
    &quot;trajectory_length&quot;: 600,       # length of trajectories (i.e. number of steps) inside data files
    &quot;n_trajectories&quot;: 1000,         # number of trajectories inside train.h5
    &quot;n_trajectories_valid&quot;: 100,    # number of trajectories inside valid.h5
    &quot;dims&quot;: 2,                      # dimension of the mesh
    &quot;feature_names&quot;: [              # names of all features, mesh_pos and node_type are required
        &quot;cells&quot;,
        &quot;mesh_pos&quot;,
        &quot;node_type&quot;,
        &quot;velocity&quot;
    ],
    &quot;target_features&quot;: [            # names of target features (i.e. quantities of interest) as output of the network
        &quot;velocity&quot;
    ],
    &quot;features&quot;: {                   # detailed information of the features given above
      &quot;cells&quot;: {                    # name of the feature given above
        &quot;type&quot;: &quot;static&quot;,           # &quot;static&quot; if the feature does not change over time, &quot;dynamic&quot; otherwise
        &quot;dim&quot;: 3,                   # dimension of the feature
        &quot;shape&quot;: [                  # individual dimensions of the feature, one dimension can be inferred from data via -1
          1,
          -1,
          3
        ],
        &quot;dtype&quot;: &quot;int32&quot;            # data type of the feature
      },
      &quot;mesh_pos&quot;: {
        &quot;type&quot;: &quot;static&quot;,
        &quot;dim&quot;: 2,
        &quot;shape&quot;: [
          1,
          -1,
          2
        ],
        &quot;dtype&quot;: &quot;float32&quot;
      },
      &quot;node_type&quot;: {
        &quot;type&quot;: &quot;static&quot;,
        &quot;dim&quot;: 1,
        &quot;shape&quot;: [
          1,
          -1,
          1
        ],
        &quot;dtype&quot;: &quot;int32&quot;,
        &quot;onehot&quot;: true,             # should the feature be represented as a onehot vector (optional)
        &quot;data_min&quot;: 0,              # minimum value of the feature (optional, required if &quot;data_max&quot; specified)
        &quot;data_max&quot;: 6               # maximum value of the feature (optional, required if &quot;data_min&quot; specified)
      },
      &quot;velocity&quot;: {
        &quot;type&quot;: &quot;dynamic&quot;,
        &quot;dim&quot;: 2,
        &quot;shape&quot;: [
          600,
          -1,
          2
        ],
        &quot;dtype&quot;: &quot;float32&quot;
      }
    }
  }</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../overview/">« Overview</a><a class="docs-footer-nextpage" href="../train_eval/">Training &amp; Evaluation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Wednesday 17 July 2024 11:57">Wednesday 17 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
