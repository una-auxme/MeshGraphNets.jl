<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>CylinderFlow · MeshGraphNets.jl</title><meta name="title" content="CylinderFlow · MeshGraphNets.jl"/><meta property="og:title" content="CylinderFlow · MeshGraphNets.jl"/><meta property="twitter:title" content="CylinderFlow · MeshGraphNets.jl"/><meta name="description" content="Documentation for MeshGraphNets.jl."/><meta property="og:description" content="Documentation for MeshGraphNets.jl."/><meta property="twitter:description" content="Documentation for MeshGraphNets.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../overview/">Overview</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../training_data/">Training Data</a></li><li><a class="tocitem" href="../train_eval/">Training &amp; Evaluation</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>CylinderFlow</a><ul class="internal"><li><a class="tocitem" href="#Data-Preparation"><span>Data Preparation</span></a></li><li><a class="tocitem" href="#Training-the-Network"><span>Training the Network</span></a></li><li><a class="tocitem" href="#Evaluating-the-Trained-Network"><span>Evaluating the Trained Network</span></a></li><li><a class="tocitem" href="#Addition:-Arguments-for-Training-and-Evaluation"><span>Addition: Arguments for Training &amp; Evaluation</span></a></li></ul></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../strategies/">Training Strategies</a></li><li><a class="tocitem" href="../util/">Utilities</a></li><li><a class="tocitem" href="../graph_net_core/">GraphNetCore.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>CylinderFlow</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>CylinderFlow</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/una-auxme/MeshGraphNets.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="CylinderFlow-by-Google-DeepMind"><a class="docs-heading-anchor" href="#CylinderFlow-by-Google-DeepMind">CylinderFlow by Google DeepMind</a><a id="CylinderFlow-by-Google-DeepMind-1"></a><a class="docs-heading-anchor-permalink" href="#CylinderFlow-by-Google-DeepMind" title="Permalink"></a></h1><p>This examples provides information on preparing the data for the <code>CylinderFlow</code> example provided by <a href="https://deepmind.google/">Google DeepMind</a> in their corresponding <a href="https://github.com/google-deepmind/deepmind-research/tree/master/meshgraphnets">repository</a> an how you can train and evaluate the resulting network.</p><h2 id="Data-Preparation"><a class="docs-heading-anchor" href="#Data-Preparation">Data Preparation</a><a id="Data-Preparation-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Preparation" title="Permalink"></a></h2><p>First you need to download the provided datasets for training, evaluation and testing. An explanation on how you can download the files is provided in the repository:</p><blockquote><p><a href="https://github.com/google-deepmind/deepmind-research/tree/master/meshgraphnets#datasets">https://github.com/google-deepmind/deepmind-research/tree/master/meshgraphnets#datasets</a></p></blockquote><p>If you execute the file <a href="https://github.com/google-deepmind/deepmind-research/blob/master/meshgraphnets/download_dataset.sh">download_dataset.sh</a> with the argument <code>cylinder_flow</code> the following files should download:</p><ul><li><code>meta.json</code></li><li><code>train.tfrecord</code></li><li><code>valid.tfrecord</code></li><li><code>test.tfrecord</code></li></ul><p>You can keep the <code>.tfrecord</code> files as is. You only need to change the <code>meta.json</code> file to be compatible with <em>MeshGraphNets.jl</em>. The correct file is provided in the <a href="https://github.com/una-auxme/MeshGraphNets.jl/tree/main/examples/cylinder_flow">examples folder</a> and you only need to copy it to the same folder as the <code>.tfrecord</code> files.</p><blockquote><p>If you want to understand the structure of the <code>meta.json</code> file take a look at the section <a href="https://una-auxme.github.io/MeshGraphNets.jl/dev/training_data">Training Data</a>.</p></blockquote><p>The default path for the data folder that is specified in the <a href="https://github.com/una-auxme/MeshGraphNets.jl/blob/main/examples/cylinder_flow/cylinder_flow.jl">example script</a> is:</p><pre><code class="nohighlight hljs">{path_to_cylinder_flow.jl}/data/datasets/</code></pre><h2 id="Training-the-Network"><a class="docs-heading-anchor" href="#Training-the-Network">Training the Network</a><a id="Training-the-Network-1"></a><a class="docs-heading-anchor-permalink" href="#Training-the-Network" title="Permalink"></a></h2><p>In order to train the system you can simply comment in/out the lines of code provided in the script:</p><pre><code class="language-julia hljs">#################
# Train network #
#################

# with DerivativeTraining

train_network(
    noise, opt, ds_path, chk_path; mps = message_steps, layer_size = layer_size, hidden_layers = hidden_layers, batchsize = batch,
    epochs = epo, steps = Int(ns), use_cuda = cuda, checkpoint = cp, norm_steps = 1000, types_updated = types_updated,
    types_noisy = types_noisy, training_strategy = DerivativeTraining(), solver_valid = Euler(), solver_valid_dt = 0.01f0
)

# with SolverTraining

train_network(
    noise, opt, ds_path, chk_path; mps = message_steps, layer_size = layer_size, hidden_layers = hidden_layers, batchsize = batch, epochs = epo,
    steps = Int(ns), use_cuda = cuda, checkpoint = 10, norm_steps = 1000, types_updated = types_updated, types_noisy = types_noisy,
    training_strategy = SolverTraining(0.0f0, 0.01f0, 5.99f0, Euler(); adaptive = false, tstops = 0.0f0:0.01f0:5.99f0)
)</code></pre><h2 id="Evaluating-the-Trained-Network"><a class="docs-heading-anchor" href="#Evaluating-the-Trained-Network">Evaluating the Trained Network</a><a id="Evaluating-the-Trained-Network-1"></a><a class="docs-heading-anchor-permalink" href="#Evaluating-the-Trained-Network" title="Permalink"></a></h2><p>The same applies to evaluating the system. Simply comment in/out the desired lines of code:</p><pre><code class="language-julia hljs">####################
# Evaluate network #
####################

# with Euler (fixed timestep)

eval_network(
    ds_path, chk_path, eval_path, Euler(); start = 0.0f0, stop = 5.99f0, dt = 0.01f0, saves = 0.0f0:0.01f0:5.99f0,
    mse_steps = collect(0.0f0:1.0f0:5.99f0), mps = message_steps, layer_size = layer_size, hidden_layers = hidden_layers, use_cuda=cuda
)

# with Tsit5 (adaptive timestep)

eval_network(
    ds_path, chk_path, eval_path, Tsit5(); start = 0.0f0, stop = 5.99f0, saves = 0.0f0:0.01f0:5.99f0,
    mse_steps = collect(0.0f0:1.0f0:5.99f0), mps = message_steps, layer_size = layer_size, hidden_layers = hidden_layers, use_cuda=cuda
)
</code></pre><h2 id="Addition:-Arguments-for-Training-and-Evaluation"><a class="docs-heading-anchor" href="#Addition:-Arguments-for-Training-and-Evaluation">Addition: Arguments for Training &amp; Evaluation</a><a id="Addition:-Arguments-for-Training-and-Evaluation-1"></a><a class="docs-heading-anchor-permalink" href="#Addition:-Arguments-for-Training-and-Evaluation" title="Permalink"></a></h2><p>The arguments provided at the top of the example script and in the function call correspond to the default values that were used by DeepMind. You can change them to see how that affects runtime and accuracy of the network.</p><p>The arguments inside the function calls can also be modified. An explanation can be found in section <a href="https://una-auxme.github.io/MeshGraphNets.jl/dev/train_eval">Training &amp; Evaluation</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../train_eval/">« Training &amp; Evaluation</a><a class="docs-footer-nextpage" href="../strategies/">Training Strategies »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Wednesday 17 July 2024 11:14">Wednesday 17 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
